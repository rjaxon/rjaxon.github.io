<html>

    <head>
        <title>
            Music Notes
        </title>

        <script src="https://ajax.aspnetcdn.com/ajax/jQuery/jquery-3.6.2.min.js"></script>
    </head>

<style>

body {
    font-weight: 2em;
}

div {
    padding: 1em;
}

.board {
    padding: 0em;
    width: 1000px;
    height: 588px;
    background-image: url('./caged-Cmaj-amin.png');
    background-repeat: repeat;
}

.board-top {
    height: 60px;
}

.board-main{
    height: 371px;
    width: 1074px;
    background-position: 0px -70px;
}

.board-bottom{
    height: 94px;
    background-position: 0px 0px;
    background-image: url('./scales-major.png');
    background-repeat: repeat;
    width: 915px;
}

.set-c {
    background-position: 0px -70px;
}

.set-g {
    background-position: -332px -70px;
}

.set-d {
    background-position: -664px -70px;
}

.set-a {
    background-position: -198px -70px;
}

.set-e {
    background-position: 269px -70px;
}

.set-b {
    background-position: -65px -70px;
}

.scale-c {
    background-position: 0px 0px;
}

.scale-g {
    background-position: 0px -114px;
}

.scale-d {
    background-position: 0px -228px;
}

.scale-a {
    background-position: 0px -380px;
}

.scale-e {
    background-position: 0px -494px;
}

.scale-b {
    background-position: 0px -608px;
}

.buttons {
    div {
        cursor: pointer;
        background: orange;
        display: inline-block;
        margin: .25em;
        width: 5em;
        height: 5em;
        max-width: 5em;
        max-height: 5em;
        border-radius: 10px;
        font-weight: bold;
        text-align: center;

    }

    div.nowork {
      cursor: default;
      background: #CCC;
    }

    div.empty {
      cursor: default;
      background: white;
        width: 5em;
    }
}

.no-flats {
    background-image: url('./caged-no-flats.png');
}

.pentatonic {
    background-image: url('./caged-pentatonic.png');
}

.triads {
    background-image: url('./triads.png');
}

.minor {
    background-image: url('./minor.png');
}

.hidden {
  display: none;
}

.minor.pentatonic {
    background-position: 0px -498px;
}

.minor.triads {
    background-position: 0px -911px;
}




</style>
    <body>


        <div>
            <img src="./NOTES-Cmaj.png" style="width: 946px" />
        </div>

        <div>
            <img src="./fretboard Natural.jpg" style="width: 1003px" />
        </div>

        <div class="buttons">
            <div onclick="board_toggle_class('no-flats')"> Hide Flats </div>
            <div onclick="board_toggle_class('pentatonic')"> Pentatonic </div>
            <div onclick="board_toggle_class('triads')"> Triads </div>
            <div onclick="board_toggle_class('minor')"> Minor </div>
        </div>

        <div>

            <div class="board board-top">
            </div>
            <div id="board" class="board board-main set-c">
            </div>
            <div id="board-bottom" class="board board-bottom">
                <pre id="scale-text" class="hidden">
         1 - 2 - 3 4 - 5 - 6 - 7 1
C Major  C . D . E F . G . A . B C

                </pre>
            </div>
        </div>

        <div class="buttons keys ">
            <div onclick="on_key_click('c')" minor="a"> C/a </div>
            <div onclick="on_key_click('g')" minor="e"> G/e </div>
            <div onclick="on_key_click('d')" minor="b"> D/b </div>
            <div onclick="on_key_click('a')" minor="f_s"> A/f&sharp; </div>
            <div onclick="on_key_click('e')" minor="c_s"> E/c&sharp; </div>
            <div onclick="on_key_click('b')" minor="g_s"> B/g&sharp; </div>
        </div>
        <div class="buttons keys ">
          <div class="nowork"> F&natural;/d </div> <!-- natural used because of odd rendering -->
            <div class="nowork"> B&flat;/g </div>
            <div class="nowork"> E&flat;/c </div>
            <div class="nowork"> A&flat;/f </div>
            <div class="nowork"> D&flat;/b&flat; </div>
            <div class="nowork"> G&flat;/e&flat; <!--span>(F&sharp;/d&sharp;)</span--> </div>
        </div>

        <div>
            Drum Tracks from <a href="https://www.midnightdrummer.com/backing-drum-tracks/" target="_blank">midnightdrummer.com</a>
        </div>

        <div>
            <audio controls loop>
                  <source id="audio-player" src="./tracks/Basic-Shuffle-Groove-120-BPM.mp3" type="audio/mpeg" />
                  Your browser does not support the audio element.
            </audio>
        </div>

    </body>

    <script type="text/javascript">

        let keys = {
'c': { "desc": `
         1  -  2  -  3  4  -  5  -  6  -  7  1
C Major  C  .  D  .  E  F  .  G  .  A  .  B  C
         1  -  2  -  3  -  -  5  -  6  -  -  1 
         C  .  D  .  E  .  .  G  .  A  .  .  C
` },

'g': { "desc": `
         1  -  2  -  3  4  -  5  -  6  -  7  1
G Major  G  .  A  .  B  C  .  D  .  E  .  F# G
         1  -  2  -  3  -  -  5  -  6  -  -  1 
         G  .  A  .  B  .  .  D  .  E  .  .  G
`},
'd': "",
'a': "",
'e': "",
'b': ""
};

        function on_key_click(new_key) {
            
            let keys = ['c', 'g', 'd', 'a', 'e', 'b'];
            let $board = $('#board');
            let $scale = $('#board-bottom');

            keys.forEach(key => {
                $board.removeClass('set-' + key);
                $scale.removeClass('scale-' + key);
            });

            $board.addClass('set-' + new_key);
            $scale.addClass('scale-' + new_key);
        }

        function board_toggle_class(css_class) {
            let $board = $('#board');

            if($board.hasClass(css_class)) {
                $board.removeClass(css_class);
            }
            else {
                $board.addClass(css_class);
            }
        }

        function on_load() {

          let params = document.location.href.split('?');

          let args = null;

          if(params.length > 1) {

            args = {};

            let paramlist = params[1].split('&');


            for(let i = 0; i < paramlist.length; ++i) {
              let current = paramlist[i];
              let _arg = current.split('=');
              let arg = _arg[0];
              let val = _arg[1];

              args[arg] = val;
            }
          }
          console.log(args);


          if(args) {
            if(args.key && '_c_g_d_a_e_b_'.indexOf(args.key) > 0) {
              on_key_click(args.key);
            }

            if(args['minor']) {
              board_toggle_class('minor');
            }

            if(args['no-flats']) {
              board_toggle_class('no-flats');
            }

            // these are exclusive so if more than one are in the url,
            // then the first one found will be used and the others are ignored.
            if(args['triads']) {
              board_toggle_class('triads');
            }
            else if(args['pentatonic']) {
              board_toggle_class('pentatonic');
            }
          }
        }

        $(document).ready(on_load);

    </script>
</html>
