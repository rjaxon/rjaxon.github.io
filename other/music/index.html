<html>

    <head>
        <title>
            Music Notes
        </title>

        <script src="https://ajax.aspnetcdn.com/ajax/jQuery/jquery-3.6.2.min.js"></script>

        <script src="https://cdnjs.cloudflare.com/ajax/libs/howler/2.2.3/howler.min.js"></script>
  
    </head>

<style>

body {
    font-weight: 2em;
}

div {
    padding: 1em;
}

#notes {

/* relative necessary because child .note
   use absolute positioning */
    position: relative;
    padding: 0em;
    width: 946px;
    height: 478px;

    background-image: url('./NOTES-Cmaj-2-clear.png');
    background-repeat: no-repeat;
}

.note {
    padding: 0em;
    width: 40px;
    height: 60px;
    position: absolute;
    background-image: url('./NOTES-Cmaj-2.png');
    background-repeat: no-repeat;
}

.note-none {
    background-position: -152px -109px;
}

.flat {
    padding: 0em;
    width: 15px;
    height: 20px;
    position: relative;
    background-image: url('./NOTES-Cmaj-2.png');
    background-repeat: no-repeat;
    background-position: -27px -490px;
}

.sharp {
    padding: 0em;
    width: 15px;
    height: 20px;
    position: absolute;
    background-image: url('./NOTES-Cmaj-2.png');
    background-repeat: no-repeat;
    background-position: -5px -490px;
}

.natural {
    padding: 0em;
    width: 15px;
    height: 20px;
    position: relative;
    background-image: url('./NOTES-Cmaj-2.png');
    background-repeat: no-repeat;
    background-position: -47px -490px;
}


.board {
    padding: 0em;
    width: 1000px;
    height: 588px;
    background-image: url('./caged-Cmaj-amin.png');
    background-repeat: repeat;
}

.board-top {
    height: 60px;
}

.board-main{
    height: 371px;
    width: 1074px;
    background-position: 0px -70px;
}

.board-bottom{
    height: 94px;
    background-position: 0px 0px;
    background-image: url('./scales-major.png');
    background-repeat: repeat;
    width: 915px;
}

.set-c {
    background-position: 0px -70px;
}

.set-g {
    background-position: -332px -70px;
}

.set-d {
    background-position: -664px -70px;
}

.set-a {
    background-position: -198px -70px;
}

.set-e {
    background-position: 269px -70px;
}

.set-b {
    background-position: -65px -70px;
}

.set-f {
    background-position: -465px -70px;
}

.set-bf {
    background-position: -133px -70px;
}

.set-ef {
    background-position: 202px -70px;
}


.set-af {
    background-position: -265px -70px;
}


.set-df {
    background-position: -733px -70px;
}

.set-gf {
    background-position: -397px -70px;
}

.buttons {
    div {
        cursor: pointer;
        background: orange;
        display: inline-block;
        margin: .25em;
        width: 5em;
        height: 5em;
        max-width: 5em;
        max-height: 5em;
        border-radius: 10px;
        font-weight: bold;
        text-align: center;

    }

    div.disabled {
      cursor: default;
      background: #CCC;
    }

    div.empty {
      cursor: default;
      background: white;
        width: 5em;
    }
}

.no-flats {
    background-image: url('./caged-no-flats.png');
}

.pentatonic {
    background-image: url('./caged-pentatonic.png');
}

.triads {
    background-image: url('./triads.png');
}

.minor {
    background-image: url('./minor.png');
}

.hidden {
  display: none;
}

.minor.pentatonic {
    background-position-y: -498px;
}

.minor.triads {
    background-position-y: -911px;
}

.on {
    background: #f4e519 !important;
}

.selected {
    background: #f4e519 !important;
}

.selected-as-minor {
    background: #75cf3f !important;
}

.red {
    color: red;
}

.penta-omit {
    color: #ccc;
}


</style>
    <body>

        <div>
            <div id="notes">
                <div class="note note-none hidden" style="left: 108px; top: 64px;" ></div>
                <!--div class="note note-f" style="left: 152px; top: 40px;" ></div>
                <div class="sharp" style="left: 144px; top: 46px;" ></div-->
            </div>
        </div>

        <div>
            <img src="./fretboard Natural.jpg" style="width: 1003px" />
        </div>



        <div class="buttons">
            <div id="btn-no-flats" onclick="board_toggle_class('no-flats', this)"> Hide Flats </div>
            <div id="btn-pentatonic" onclick="board_toggle_class('pentatonic', this)"> Pentatonic </div>
            <div id="btn-triads" onclick="board_toggle_class('triads', this)"> Triads </div>
            <div id="btn-minor" onclick="board_toggle_class('minor', this)"> Minor </div>
        </div>

        <div>

            <div class="board board-top">
            </div>
            <div id="board" class="board board-main set-c">
            </div>
            <div id="board-bottom" class="board board-bottom hidden">
            </div>
            <div>
                <table border=0 style="font-family: monospace; font-size: 30px; width: 950px; font-weight: bold; text-align: center;">
                    <tr id="major_header"> <td>&nbsp;</td>
                         <th> 1 </th>
                         <th> - </th>
                         <th> 2 </th>
                         <th> - </th>
                         <th> 3 </th>
                         <th> 4 </th>
                         <th> - </th>
                         <th> 5 </th>
                         <th> - </th>
                         <th> 6 </th>
                         <th> - </th>
                         <th> 7 </th>
                         <th> 1 </th> </tr>
                    <tr id="minor_header" class="hidden"> <td>&nbsp;</td>
                         <th> 1 </th>
                         <th> - </th>
                         <th> 2 </th>
                         <th> 3 </th>
                         <th> - </th>
                         <th> 4 </th>
                         <th> - </th>
                         <th> 5 </th>
                         <th> 6 </th>
                         <th> - </th>
                         <th> 7 </th>
                         <th> - </th>
                         <th> 1 </th> </tr>
                    <tr> <td style="width: 180px;" id="sc-name">C Major</td>
                         <td id="sc-1" class="red" > </td>
                         <td id="sc-2" > </td>
                         <td id="sc-3" > </td>
                         <td id="sc-4" class="red" > </td>
                         <td id="sc-5" class="red" > </td>
                         <td id="sc-6" > </td>
                         <td id="sc-7" > </td>
                         <td id="sc-8" class="red" > </td>
                         <td id="sc-9" > </td>
                         <td id="sc-10"> </td>
                         <td id="sc-11"> </td>
                         <td id="sc-12"> </td>
                         <td id="sc-13"> </td> </tr>
                </table>
            </div>
        </div>

        <div class="buttons keys ">
            <div id="btn-c" onclick="on_key_click('c', 'am', this)"  major="c" minor="am" > C / a </div>
            <div id="btn-g" onclick="on_key_click('g', 'em', this)"  major="g" minor="em" > G / e </div>
            <div id="btn-d" onclick="on_key_click('d', 'bm', this)"  major="d" minor="bm" > D / b </div>
            <div id="btn-a" onclick="on_key_click('a', 'fsm', this)" major="a" minor="fsm"> A / f&sharp; </div>
            <div id="btn-e" onclick="on_key_click('e', 'csm', this)" major="e" minor="csm"> E / c&sharp; </div>
            <div id="btn-b" onclick="on_key_click('b', 'gsm', this)" major="b" minor="gsm"> B / g&sharp; </div>
        </div>
        <div class="buttons keys ">
            <div id="btn-f"  onclick="on_key_click('f', 'dm', this)"  major="f" minor="dm" > F&natural; / d </div><!-- natural used because of odd rendering -->
            <div id="btn-bf" onclick="on_key_click('bf', 'gm', this)"  major="bf" minor="gm" > B&flat; / g </div>
            <div id="btn-ef" onclick="on_key_click('ef', 'cm', this)"  major="ef" minor="cm" > E&flat; / c </div>
            <div id="btn-af" onclick="on_key_click('af', 'fm', this)"   major="af" minor="fm" > A&flat; / f </div>
            <div id="btn-df" onclick="on_key_click('df', 'bfm', this)"  major="df" minor="bfm" > D&flat; / b&flat; </div>
            <div id="btn-gf" onclick="on_key_click('gf', 'efm', this)"  major="gf" minor="efm" > G&flat; / e&flat; </div>
        </div>

        <div>
            Drum Tracks from <a href="https://www.midnightdrummer.com/backing-drum-tracks/" target="_blank">midnightdrummer.com</a>
        </div>

        <div>
            <audio controls loop >
                  <source id="audio-player" src="./tracks/Basic-Shuffle-Groove-120-BPM.mp3" type="audio/mpeg" />
                  Your browser does not support the audio element.
            </audio>
        </div>

        <!--div class="buttons">
          <div id="audio" onclick="play_track();">PLAY</div>
        </div-->

    </body>

    <script type="text/javascript">

let keys = { };
keys.c   = 'C Major, C, D, E, F, G, A, B, C';
keys.am  = 'a minor, A, B, C, D, E, F, G, A';
keys.g   = 'G Major, G, A, B, C, D, E, F&sharp;, G';
keys.em  = 'e minor, E, F&sharp;, G, A, B, C, D, E';
keys.d   = 'D Major, D, E, F&sharp;, G, A, B, C&sharp;, D';
keys.bm  = 'b minor, B, C&sharp;, D, E, F&sharp;, G, A, B';
keys.a   = 'A Major, A, B, C&sharp;, D, E, F&sharp;, G&sharp;, A';
keys.fsm = 'f&sharp; minor, F&sharp;, G&sharp;, A, B, C&sharp;, D, E, F&sharp;';
keys.e   = 'E Major, E, F&sharp;, G&sharp;, A, B, C&sharp;, D&sharp;, E';
keys.csm = 'c&sharp; minor, C&sharp;, D&sharp;, E, F&sharp;, G&sharp;, A, B, C&sharp;';
keys.b   = 'B Major, B, C&sharp;, D&sharp;, E, F&sharp;, G&sharp;, A&sharp;, B';
keys.gsm = 'g&sharp; minor, G&sharp;, A&sharp;, B, C&sharp;, D&sharp;, E, F&sharp;, G&sharp;';
keys.f   = 'F Major, F, G, A, B&flat;, C, D, E, F';
keys.dm  = 'd minor, D, E, F, G, A, B&flat;, C, D';
keys.bf  = 'B&flat; Major, B&flat;, C, D, E&flat;, F, G, A, B&flat;';
keys.gm  = 'g minor, G, A, B&flat;, C, D, E&flat;, F, G';
keys.ef  = 'E&flat; Major, E&flat;, F, G, A&flat;, B&flat;, C, D, E&flat;';
keys.cm  = 'c minor, C, D, E&flat;, F, G, A&flat;, B&flat;, C';

keys.af  = 'A&flat; Major, A&flat;, B&flat;, C, D&flat;, E&flat;, F, G, A&flat;';
keys.fm  = 'f minor, F, G, A&flat;, B&flat;, C, D&flat;, E&flat;, F';

keys.df  = 'D&flat; Major, D&flat;, E&flat;, F, G&flat;, A&flat;, B&flat;, C, D&flat;';
keys.bfm = 'b&flat; minor, B&flat;, C, D&flat;, E&flat;, F, G&flat;, A&flat;, B&flat;';

keys.gf  = 'G&flat; Major, G&flat;, A&flat;, B&flat;, C&flat;, D&flat;, E&flat;, F, G&flat;';
keys.efm = 'e&flat; minor, E&flat;, F, G&flat;, A&flat;, B&flat;, C&flat;, D&flat;, E&flat;';

        function on_key_click(major_key, minor_key, sender) {
            
          let _keys = ['c', 'g', 'd', 'a', 'e', 'b', 'f',
                       'bf', 'ef', 'af', 'df', 'gf'];
          let $board = $('#board');
          let $scale = $('#board-bottom');
          $s = $(sender);


          _keys.forEach(key => {
              $board.removeClass('set-' + key);
              $scale.removeClass('scale-' + key);
          });

          for(let i = 1; i <= 13; ++i) {
              let $c = $('#sc-' + i );
              $c.html('');
              $c.removeClass('penta-omit');
              
          }


          let $pentatonic = $('#btn-pentatonic');
          let $triads = $('#btn-triads');
          let $minor = $('#btn-minor');
          let $selected = $('.selected');
          let was_minor = $selected.hasClass('selected-as-minor');
          $selected.removeClass('selected-as-minor');
          $selected.removeClass('selected');
          $s.addClass('selected');

          if($minor.hasClass('on')) {
            $s.addClass('selected-as-minor');
          }

          // if already selected, should it toggle to minor?
          
          // if($selected.length > 0 && $s.length > 0) {
          //   if($selected[0].id == $s[0].id) {
          //     if(!was_minor) {
          //       $s.addClass('selected-as-minor');
          //       // set up as minor
          //     }
          //     else {
          //       // set up as major
          //     }
          //   }
          // }


          $board.addClass('set-' + major_key);
          $scale.addClass('scale-' + major_key);

          let is_major = true;
          // if($board.hasClass('minor')) {
          if($minor.hasClass('on')) {
            is_major = false;
            $('#major_header').addClass('hidden');
            $('#minor_header').removeClass('hidden');
          }
          else {
            $('#major_header').removeClass('hidden');
            $('#minor_header').addClass('hidden');
          }

          let _newkey = is_major ? major_key : minor_key;
          if(keys[_newkey]) {
            let k = keys[ _newkey ].split(', ');

            let is_5 = $pentatonic.hasClass('on');
            update_scale(k, is_major, is_5);
          }


        }

        function update_scale(keys, is_major, is_5) {

          let k = keys;
          $('#sc-name' ).html(k[0]); 

          if(is_major) {
            $('#sc-1' ).html(k[1]); 
            $('#sc-3' ).html(k[2]); 
            $('#sc-5' ).html(k[3]); 
            $('#sc-6' ).html(k[4]); 
            $('#sc-8' ).html(k[5]); 
            $('#sc-10').html(k[6]); 
            $('#sc-12').html(k[7]); 
            $('#sc-13').html(k[8]); 

            if(is_5) {
              $('#sc-6' ).addClass('penta-omit');
              $('#sc-12' ).addClass('penta-omit');
            }
          }
          else {
            $('#sc-1' ).html(k[1]); 
            $('#sc-3' ).html(k[2]); 
            $('#sc-4' ).html(k[3]); 
            $('#sc-6' ).html(k[4]); 
            $('#sc-8' ).html(k[5]); 
            $('#sc-9' ).html(k[6]); 
            $('#sc-11').html(k[7]); 
            $('#sc-13').html(k[8]); 
            if(is_5) {
              $('#sc-3' ).addClass('penta-omit');
              $('#sc-9' ).addClass('penta-omit');
            }
          }

        }

        function board_toggle_class(css_class, sender) {
            let $board = $('#board');

            if(sender) {
                let $s = $(sender);
                if($s.hasClass('on') ) {
                    $s.removeClass('on');
                }
                else {
                    $s.addClass('on');
                }
            }

            if($board.hasClass(css_class)) {
                $board.removeClass(css_class);
                if(css_class === 'minor') {
                  console.log('minor toggle off');

                  // update buttons and scale
                } 
                else if(css_class === 'pentatonic') {
                  $('.penta-omit').removeClass('penta-omit');
                }
            }
            else {
                $board.addClass(css_class);
                if(css_class === 'minor') {
                  console.log('minor toggle on');

                  // update buttons and scale
                  // let $minor = $('#btn-minor');
                  // let is_major = $minor.hasClass('on');
                  // let _newkey = is_major ? major_key : minor_key;
                  // let k = keys[ _newkey ].split(', ');
                  // let is_5 = $pentatonic.hasClass('on');
                  // update_scale(k, is_major, is_5);
                }
                else if(css_class === 'pentatonic') {
                  // update penta scale notes
                  // let $minor = $('#btn-minor');
                  // let is_major = $minor.hasClass('on');
                  // let k = keys[ _newkey ].split(', ');
                  // let is_5 = $pentatonic.hasClass('on');
                  // update_scale(k, is_major, is_5);

                }
            }

        }

        function on_load() {

          let params = document.location.href.split('?');

          let args = null;

          if(params.length > 1) {

            args = {};

            let paramlist = params[1].split('&');


            for(let i = 0; i < paramlist.length; ++i) {
              let current = paramlist[i];
              let _arg = current.split('=');
              let arg = _arg[0];
              let val = _arg[1];

              args[arg] = val;
            }
          }
          console.log(args);


          if(args) {

            if(args['minor']) {
              let $btn = $('#btn-minor');
              $btn.addClass('on');
              board_toggle_class('minor');
            }

            if(args['no-flats']) {
              let $btn = $('#btn-no-flats');
              $btn.addClass('on');
              board_toggle_class('no-flats');
            }

            // these are exclusive so if more than one are in the url,
            // then the first one found will be used and the others are ignored.
            if(args['triads']) {
              let $btn = $('#btn-triads');
              $btn.addClass('on');
              board_toggle_class('triads');
            }
            else if(args['pentatonic']) {
              let $btn = $('#btn-pentatonic');
              $btn.addClass('on');
              board_toggle_class('pentatonic');
            }


            let accepted_major  = '_c_g_d_a_e_b_f_bf_ef_af_df_gf_';
            let accepted_minor = '_am_em_bm_fsm_csm_gsm_dm_gm_cm_fm_bfm_efm_';


            if(args.key) {
              if(accepted_major.indexOf('_' + args.key + '_') >= 0) {
                $button = $('[major="' + args.key + '"]');
                // on_key_click(args.key, 'am');
                on_key_click($button.attr('major'), $button.attr('minor'), $button[0]);
              }
              else if(accepted_minor.indexOf('_' + args.key + '_') >= 0) {
                $button = $('[minor="' + args.key + '"]');
                // on_key_click('c', args.key);
                on_key_click($button.attr('major'), $button.attr('minor'), $button[0]);
              }
            }
            else {
              on_key_click('c', 'am');
            }

          }

          notes_load('C');
        }

        let sound = null;
        function play_track() {
            if(sound == null) {
                sound = new Howl({
                  src: ['./tracks/Basic-Shuffle-Groove-120-BPM.mp3'],
                  loop: true
                });
            }

          let $audio = $('#audio');
          if($audio.html().trim() == 'PLAY') {
            sound.play();
            $audio.html('STOP');
          }
          else if($audio.html().trim() == 'STOP') {
            sound.stop();
            $audio.html('PLAY');
          }
          
        }

        $(document).ready(on_load);

let note_data = {E: {}, A: {}, G: {}, B: {}, e: {}};

note_data.note = {};

//  [bg-x, bg-y, offset-x, offset-y]        

note_data.note.none = [-152, -109];

note_data.note.e1 = [-12, -440, 0, 55, 40, 30 ];
note_data.note.f1 = [-84, -440, 0, 55, 40, 30 ];
note_data.note.g1 = [-218, -440, 0, 55, 40, 30];
note_data.note.a1 = [-12, -370, 0, 53, 40, 20 ];
note_data.note.b1 = [-151, -370, 0, 53, 40, 20];
note_data.note.c1 = [-219, -370, 5, 53, 40, 20];
note_data.note.d1 = [-351, -503, 0, 49, 19, 9 ];


note_data.note.e2 = [-351, -502, 0, 46, 19, 11 ];
note_data.note.f2 = [-351, -502, 3, 41, 19, 11 ];
note_data.note.g2 = [-351, -502, 0, 38, 19, 11 ];
note_data.note.a2 = [-351, -502, 0, 34, 19, 11 ];
note_data.note.b2 = [-351, -502, 0, 30, 19, 11 ];
note_data.note.c2 = [-351, -502, 0, 27, 19, 11 ];
note_data.note.d2 = [-351, -502, 0, 22, 19, 11 ];

note_data.note.e3 = [-351, -501, 3, 18, 19, 11 ];
note_data.note.f3 = [-351, -501, 3, 14, 19, 11 ];
note_data.note.g3 = [-351, -501, 3, 10, 19, 11 ];
note_data.note.a3 = [-348, -40];
note_data.note.b3 = [-484, -40];
note_data.note.c3 = [-883, -109];
note_data.note.d3 = [-683,-493, 0, -5];

note_data.note.e4 = [-12, -40];
note_data.note.f4 = [-79, -40];
note_data.note.g4 = [-218, -40];
note_data.note.a4 = [-348, -40];
note_data.note.b4 = [-484, -40];
note_data.note.c4 = [-883, -109];
note_data.note.d4 = [-683,-493, 0, -5];


note_data.e = [14];
note_data.e[0] = [5, 40];
note_data.e[1] = [80, 40];
note_data.e[2] = [152, 40];
note_data.e[3] = [215, 40];

note_data.e[4] = [280, 40];
note_data.e[5] = [346, 40];
note_data.e[6] = [415, 40];
note_data.e[7] = [480, 40];

note_data.e[8]  = [545, 40];
note_data.e[9]  = [610, 40];
note_data.e[10] = [680, 40];
note_data.e[11] = [745, 40];

note_data.e[12] = [815, 40];
note_data.e[13] = [880, 40];

note_data.B = [14];
note_data.B[0] = [5, 109];
note_data.B[1] = [80, 109];
note_data.B[2] = [152, 109];
note_data.B[3] = [215, 109];

note_data.B[4] = [280, 109];
note_data.B[5] = [346, 109];
note_data.B[6] = [415, 109];
note_data.B[7] = [480, 109];

note_data.B[8]  = [545, 109];
note_data.B[9]  = [610, 109];
note_data.B[10] = [680, 109];
note_data.B[11] = [745, 109];

note_data.B[12] = [815, 109];
note_data.B[13] = [880, 109];


note_data.G = [14];
note_data.G[0] = [5, 178];
note_data.G[1] = [80, 178];
note_data.G[2] = [152, 178];
note_data.G[3] = [215, 178];

note_data.G[4] = [280, 178];
note_data.G[5] = [346, 178];
note_data.G[6] = [415, 178];
note_data.G[7] = [480, 178];

note_data.G[8]  = [545, 178];
note_data.G[9]  = [610, 178];
note_data.G[10] = [680, 178];
note_data.G[11] = [745, 178];

note_data.G[12] = [815, 178];
note_data.G[13] = [880, 178];

note_data.D = [14];
note_data.D[0] = [5, 248];
note_data.D[1] = [80, 248];
note_data.D[2] = [152, 248];
note_data.D[3] = [215, 248];

note_data.D[4] = [280, 248];
note_data.D[5] = [346, 248];
note_data.D[6] = [415, 248];
note_data.D[7] = [480, 248];

note_data.D[8]  = [545, 248];
note_data.D[9]  = [610, 248];
note_data.D[10] = [680, 248];
note_data.D[11] = [745, 248];

note_data.D[12] = [815, 248];
note_data.D[13] = [880, 248];

note_data.A = [14];
note_data.A[0] = [5, 317];
note_data.A[1] = [80, 317];
note_data.A[2] = [152, 317];
note_data.A[3] = [215, 317];

note_data.A[4] = [280, 317];
note_data.A[5] = [346, 317];
note_data.A[6] = [415, 317];
note_data.A[7] = [480, 317];

note_data.A[8]  = [545, 317];
note_data.A[9]  = [610, 317];
note_data.A[10] = [680, 317];
note_data.A[11] = [745, 317];

note_data.A[12] = [815, 317];
note_data.A[13] = [880, 317];

note_data.E = [14];
note_data.E[0] = [5, 386];
note_data.E[1] = [80, 386];
note_data.E[2] = [152, 386];
note_data.E[3] = [215, 386];

note_data.E[4] = [280, 386];
note_data.E[5] = [346, 386];
note_data.E[6] = [415, 386];
note_data.E[7] = [480, 386];

note_data.E[8]  = [545, 386];
note_data.E[9]  = [610, 386];
note_data.E[10] = [680, 386];
note_data.E[11] = [745, 386];

note_data.E[12] = [815, 386];
note_data.E[13] = [880, 386];


let fret_key = {};

fret_key.C = [
/*
[-------,-------,-------,-------,-------,-------,-------,-------,-------,-------,-------,-------,-------,-------,
 */
[   'e3',   'f3',      0,   'g3',      0,   'a3',      0,   'b3',    'c3',     0,   'd3',      0,   'e4',   'f4' ],                     
[   'b2',   'c2',      0,   'd2',      0,   'e3',   'f3',      0,    'g3',     0,   'a3',      0,   'b3',   'c3' ],                     
[   'g2',      0,   'a2',      0,   'b2',   'c2',      0,   'd2',       0,  'e3',   'f3',      0,   'g3',      0 ],
[   'd1',      0,   'e2',   'f2',      0,   'g2',      0,   'a2',       0,  'b2',   'c2',      0,   'd2',      0 ],
[   'a1',      0,   'b1',   'c1',      0,   'd1',      0,   'e2',    'f2',     0,   'g2',      0,   'a2',      0 ],
[   'e1',   'f1',      0,   'g1',      0,   'a1',      0,   'b1',    'c1',     0,   'd1',      0,   'e2',   'f2' ],
];


fret_key.G = [
/*
[-------,-------,-------,-------,-------,-------,-------,-------,-------,-------,-------,-------,-------,-------,
 */
[   'e3',      0, 'f3.s',   'g3',      0,   'a3',      0,   'b3',   'c3',      0,   'd3',      0,  'e4',      0 ],                     
[   'b2',   'c2',      0,   'd2',     0,    'e3',      0, 'f3.s',   'g3',      0,   'a3',      0,  'b3',      0 ],                     
[   'g2',      0,   'a2',      0,   'b2',   'c2',      0,   'd2',      0,   'e3',      0, 'f3.s',  'g3',      0 ],
[   'd1',      0,   'e2',      0, 'f2.s',   'g2',      0,   'a2',      0,   'b2',   'c2',      0,  'd2',      0 ],
[   'a1',      0,   'b1',   'c1',      0,   'd1',      0,   'e2',      0, 'f2.s',   'g2',      0,  'a2',      0 ],
[   'e1',      0, 'f1.s',   'g1',      0,   'a1',      0,   'b1',   'c1',      0,   'd1',      0,  'e2',      0 ],
];

fret_key.D = [
/*
[-------,-------,-------,-------,-------,-------,-------,-------,-------,-------,-------,-------,-------,-------,
 */
[   'e3',      0, 'f3.s',   'g3',      0,   'a3',      0,   'b3',      0, 'c3.s',   'd3',      0,  'e4',      0 ],                     
[   'b2',      0, 'c2.s',   'd2',     0,    'e3',      0, 'f3.s',   'g3',      0,   'a3',      0,  'b3',      0 ],                     
[   'g2',      0,   'a2',      0,   'b2',      0, 'c2.s',   'd2',      0,   'e3',      0, 'f3.s',  'g3',      0 ],
[   'd1',      0,   'e2',      0, 'f2.s',   'g2',      0,   'a2',      0,   'b2',      0, 'c2.s',  'd2',      0 ],
[   'a1',      0,   'b1',      0, 'c1.s',   'd1',      0,   'e2',      0, 'f2.s',   'g2',      0,  'a2',      0 ],
[   'e1',      0, 'f1.s',   'g1',      0,   'a1',      0,   'b1',      0, 'c1.s',   'd1',      0,  'e2',      0 ],
];


        function notes_load(key_to_load) {
          let key = fret_key[key_to_load];
          if(!key) {
            console.log('Key not found');
            return;
          }

          let _string = ['e', 'B', 'G', 'D', 'A', 'E'];

          for(let i = 0; i < 6; ++i) {
            for(let j = 0; j < 13; ++j) {
              let note = key[i][j];
              if(note) {
                let s = null;
                if(note.length > 2) {
                  let n = note.split('.');
                  note = n[0];
                  s = n[1];
                }
                let string = _string[i];
                let fret = j;

                notes_add(note, string, fret, s);
              }
            }
          }
        }

        function notes_clear() {
          $('#notes').empty();
        }

        function notes_add(note, string, fret, s) {
          let div = document.createElement('div');
          let $div = $(div);
          $div.addClass('note');
          if(s)
            $div.addClass(note + '.' + s);
          else
            $div.addClass(note);


          let _note = note_data.note[note];
          let left = note_data[string][fret][0];
          let _top = note_data[string][fret][1] ;

          if(_note.length >= 3) {
            left += _note[2];
          }

          if(_note.length >= 4) {
            _top += _note[3];
          }

          let width = null;
          let height = null;
          if(_note.length >= 6) {
            width = _note[4];
            height = _note[5]
          }


          let _s = null;

          if(s) {
            if(s === 's') {
              left += 3;
              _s = document.createElement('div');
              let $_s= $(_s);
              $_s.addClass('sharp');
              $_s.attr('style', `
                    left: ${left - 7}px;
                    top: ${_top - 6}px; `);

            }
            else if(s === 'f') {
            }
          }


          let style = `background-position: ${_note[0]}px ${_note[1]}px;
          left: ${left}px;
          top: ${_top}px; `;

          if(width != null && height != null) {
            style += ` width: ${width}px; height: ${height}px;`;
          }

          // $div.attr('style', 'background-position: '+ 
          //             _note[0] + 'px ' + 
          //             _note[1] +'px; left: ' +
          //             left +'px; top: ' + 
          //             _top +'px;');
          $div.attr('style', style);


          $('#notes').append(div);


          if(_s)
            $('#notes').append(_s);
        }

    </script>
</html>
